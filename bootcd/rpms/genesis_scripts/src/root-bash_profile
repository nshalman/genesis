
# Genesis modifications

# Get our configuration
source /etc/sysconfig/genesis
# If the config file is broken, use sane defaults
GENESIS_PIDFILE=${GENESIS_PIDFILE:-/var/run/genesis.pid}
GENESIS_LOGFILE=${GENESIS_LOGFILE:-/var/log/genesis-bootloader.log}

# Try for two seconds to find a pidfile
for i in {1..20}
do
	if [[ -f ${GENESIS_PIDFILE} ]]
	then
		# get the pid and break out of the for loop
		GENESIS_PID=$(cat ${GENESIS_PIDFILE})
		break
	else
		sleep .1
	fi
done

# If we found a pid and a log file, tail the log until the
# process exits
if [[ ! -z ${GENESIS_PID} ]] && [[ -f ${GENESIS_LOGFILE} ]]
then
	tail -n 10000 -f --pid=${GENESIS_PID} ${GENESIS_LOGFILE}
fi
